---
title: "9:13:14 AM - October 31, 2025"
date: 2025-10-30T20:13:14.728Z
timestamp: 1761855194728
---

## Project Notes

**Profile Provider Investigation**

The profile screen uses `ref.watch(fetchUserProfileProvider(userIdHex))` on line 322 to reactively display user profiles (avatar, username, etc).

Looking at the provider chain:
1. `fetchUserProfileProvider` (line 92-141 in user_profile_providers.dart) - Async provider that:
   - Checks cache first (line 95-98)
   - Checks if should skip (known missing) (line 101-108)
   - Calls `userProfileService.fetchProfile(pubkey)` (line 118)
   - Caches and returns result

2. `UserProfileService.fetchProfile()` (line 164-252 in user_profile_service.dart) - Service that:
   - Returns cached profile if available (line 188-205)
   - Checks for duplicate requests (line 209-211)
   - Adds to batch fetch queue (line 236-242)
   - Executes batch fetch with debounce (line 240)

Issue hypothesis: The Riverpod provider might not be invalidating/refreshing when the user navigates to the profile screen. The provider is autodispose by default, so it might be disposing and not re-fetching.

Need to check:
- Is the provider being invalidated when the screen is shown?
- Is the service actually fetching kind 0 events?
- Is the batch fetch completing successfully?
