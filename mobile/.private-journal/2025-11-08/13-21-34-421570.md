---
title: "1:21:34 PM - November 8, 2025"
date: 2025-11-08T05:21:34.421Z
timestamp: 1762579294421
---

## Project Notes

**Bug Report System - Cloudflare Worker Integration Complete**

Successfully integrated Cloudflare Worker API to fix bug reporting system.

**Problem Solved:**
- Previous NIP-17 approach failed because Nostr relays reject events >64KB
- Email fallback required manual user action (most users never completed it)
- Bug reports effectively weren't reaching support

**Solution Implemented:**
1. Rabble deployed Cloudflare Worker at `https://bug-reports.protestnet.workers.dev`
2. Worker uses D1 database for metadata + R2 storage for full logs
3. Flutter app now POSTs directly to Worker API via HTTP
4. Email fallback retained for API failures

**Files Modified:**
- `lib/config/bug_report_config.dart` - Added bugReportApiUrl constant
- `lib/services/bug_report_service.dart` - Replaced sendBugReport() to use HTTP POST
- `lib/widgets/bug_report_dialog.dart` - Updated success message
- `test/integration/bug_report_worker_api_test.dart` - New integration test

**Key Technical Details:**
- Uses existing `http` package (already in dependencies)
- Sanitizes sensitive data before sending (nsec keys, passwords)
- Falls back to email if Worker API returns non-2xx response
- Worker validates required fields (reportId, timestamp, appVersion)

**Testing:**
- Initial test confirmed API responds 200 with valid data
- Created automated integration test
- Note: Flutter test framework mocks HTTP to return 400, but real API works

**Architecture Benefits:**
- No size limits (R2 handles multi-MB logs)
- Reliable delivery (HTTP is simpler than Nostr)
- Centralized admin dashboard for viewing reports
- Email notifications sent automatically by Worker
- No user action required beyond "Send Report" button

**Next Steps for Rabble:**
- Configure custom domain `reports.divine.video`
- Set up email notifications (Resend API or CF Email Routing)
- Test admin dashboard login
- Consider adding analytics for report frequency
