{
  "embedding": [
    -0.04675789549946785,
    -0.025830896571278572,
    -0.014814385212957859,
    -0.003549254033714533,
    -0.05732344463467598,
    -0.05000010505318642,
    0.03478722646832466,
    0.05554338917136192,
    -0.06159772723913193,
    0.005832576658576727,
    -0.005794314667582512,
    -0.05768955871462822,
    0.05245347321033478,
    -0.06210070103406906,
    -0.0029600278940051794,
    -0.05678164213895798,
    0.016219161450862885,
    -0.024373605847358704,
    -0.04622909054160118,
    -0.04991138353943825,
    -0.015500341542065144,
    -0.03664841130375862,
    0.12374791502952576,
    -0.023837901651859283,
    -0.05294123664498329,
    -0.08740349113941193,
    -0.016215452924370766,
    -0.06944383680820465,
    -0.049987614154815674,
    0.000997635186649859,
    0.10935107618570328,
    0.054430972784757614,
    -0.1496184915304184,
    -0.03272247314453125,
    0.03413482755422592,
    -0.03429219499230385,
    -0.03976983577013016,
    0.04211784899234772,
    -0.021693237125873566,
    -0.031076423823833466,
    0.03594641759991646,
    -0.033191848546266556,
    -0.10065341740846634,
    -0.010511312633752823,
    0.0855192169547081,
    -0.08511076867580414,
    -0.031143350526690483,
    0.0017300592735409737,
    0.001470315968617797,
    -0.0018809951143339276,
    -0.04921220242977142,
    0.04493143409490585,
    -0.04765672981739044,
    0.022092685103416443,
    0.08141269534826279,
    0.041113730520009995,
    0.10247118771076202,
    0.044153135269880295,
    0.028136393055319786,
    0.008556002750992775,
    0.007830090820789337,
    -0.03957532346248627,
    -0.04144319146871567,
    -0.06794336438179016,
    0.009932429529726505,
    0.004872627090662718,
    -0.013632383197546005,
    0.00570893008261919,
    0.11038368195295334,
    0.016853831708431244,
    -0.030308982357382774,
    0.07230329513549805,
    -0.005684711039066315,
    0.018774177879095078,
    0.02722555585205555,
    0.05054448917508125,
    -0.04775185510516167,
    0.01481543853878975,
    0.03151169791817665,
    -0.06343477219343185,
    -0.08649913966655731,
    -0.07993628829717636,
    -0.013263163156807423,
    -0.05972442030906677,
    -0.025602679699659348,
    0.010451490990817547,
    0.06405996531248093,
    -0.06975697726011276,
    0.03756646811962128,
    0.01482787262648344,
    0.06821879744529724,
    0.06621738523244858,
    -0.04260608181357384,
    0.05761938542127609,
    0.026766374707221985,
    0.04374391585588455,
    0.06843911111354828,
    -0.011870534159243107,
    0.030073300004005432,
    0.05781194567680359,
    -0.002937721787020564,
    -0.005082564428448677,
    -0.019322538748383522,
    0.08533849567174911,
    -0.007294704206287861,
    -0.0025270506739616394,
    -0.022055573761463165,
    -0.1282191127538681,
    -0.04695108160376549,
    -0.059009626507759094,
    -0.03346618637442589,
    -0.013407326303422451,
    0.02571430243551731,
    -0.02016913890838623,
    -0.006529758684337139,
    0.035215213894844055,
    0.05164625868201256,
    0.05573812872171402,
    -0.016850154846906662,
    0.0771583542227745,
    0.13181185722351074,
    0.03344954177737236,
    0.06028108671307564,
    -0.032986901700496674,
    0.016472507268190384,
    0.008752187713980675,
    0.04432808607816696,
    8.402971408343212e-33,
    0.07037462294101715,
    -0.07374157756567001,
    -0.01987864449620247,
    0.06679064780473709,
    0.039291851222515106,
    0.040712978690862656,
    0.033847928047180176,
    0.04963202029466629,
    0.03050229512155056,
    -0.07202136516571045,
    0.04240445792675018,
    -0.0841042697429657,
    -0.030064651742577553,
    -0.0038932187017053366,
    -0.04886474087834358,
    -0.014601074159145355,
    0.03215336054563522,
    0.0074676149524748325,
    -0.029182069003582,
    0.07119232416152954,
    0.044956233352422714,
    -0.01845252700150013,
    -0.0433623306453228,
    -0.0652984082698822,
    -0.012456486001610756,
    0.04228600487112999,
    0.025372296571731567,
    0.08508151024580002,
    -0.06165142357349396,
    0.021712027490139008,
    0.011398532427847385,
    -0.01520252414047718,
    -0.036501072347164154,
    0.0678362101316452,
    -0.026572346687316895,
    0.01871464028954506,
    -0.002013508463278413,
    0.0016579884104430676,
    -0.07132166624069214,
    -0.05118059366941452,
    -0.056390441954135895,
    -0.06286044418811798,
    -0.02582959644496441,
    -0.011331409215927124,
    -0.053559254854917526,
    -0.14194728434085846,
    -0.03010725788772106,
    0.015091361477971077,
    0.10243992507457733,
    -0.008693837560713291,
    0.0333101712167263,
    0.02752828598022461,
    0.04627806320786476,
    -0.09195391088724136,
    -0.0065876394510269165,
    0.012749185785651207,
    0.009874791838228703,
    -0.013033122755587101,
    0.006839513313025236,
    0.022666551172733307,
    -0.05066097155213356,
    -0.05087544023990631,
    -0.07050596922636032,
    0.0077271973714232445,
    0.016062594950199127,
    0.009677146561443806,
    -0.061159897595644,
    -0.07472290843725204,
    0.038221538066864014,
    -0.005852268543094397,
    0.005190469324588776,
    0.04087186977267265,
    0.016404880210757256,
    -0.03759436309337616,
    -0.0411798469722271,
    -0.011847077868878841,
    0.009523766115307808,
    0.08611469715833664,
    -0.13421905040740967,
    -0.025353319942951202,
    0.12900680303573608,
    0.03155750408768654,
    -0.1377526819705963,
    0.03976307064294815,
    -0.0076595209538936615,
    0.01964000053703785,
    0.027053242549300194,
    -0.053437188267707825,
    -0.04279566928744316,
    -0.009222220629453659,
    0.06751888990402222,
    0.011432158760726452,
    0.07777460664510727,
    -0.029369313269853592,
    6.371056571197187e-8,
    -8.714190149879136e-33,
    -0.011895998381078243,
    0.049425020813941956,
    -0.08520504832267761,
    0.044024985283613205,
    0.09276001900434494,
    -0.04882628470659256,
    0.03208833187818527,
    -0.018190840259194374,
    -0.05526506155729294,
    -0.04531177133321762,
    -0.09217856079339981,
    -0.033083464950323105,
    -0.006588852498680353,
    -0.029872233048081398,
    -0.018024293705821037,
    0.03400949761271477,
    0.06745308637619019,
    -0.05628937482833862,
    0.02876461111009121,
    0.047833602875471115,
    0.042900871485471725,
    0.08918061852455139,
    -0.028223302215337753,
    -0.004586586728692055,
    -0.0881500318646431,
    0.008806951344013214,
    -0.008266503922641277,
    0.03706882521510124,
    -0.007970154285430908,
    -0.04069865122437477,
    0.08084560930728912,
    0.038612376898527145,
    -0.07934185862541199,
    0.06244829669594765,
    0.07551417499780655,
    -0.08994006365537643,
    0.05409737676382065,
    0.038507476449012756,
    -0.027459854260087013,
    0.020359061658382416,
    0.12815821170806885,
    0.008942983113229275,
    0.006665070075541735,
    -0.03429479897022247,
    0.07071840018033981,
    0.009135008789598942,
    0.05879633128643036,
    -0.007482229731976986,
    -0.029061423614621162,
    0.030641360208392143,
    0.02753441222012043,
    -0.06919200718402863,
    -0.04142829775810242,
    0.0687924176454544,
    0.030452080070972443,
    -0.010218518786132336,
    0.019215818494558334,
    -0.009221009910106659,
    0.05363542214035988,
    0.01181616261601448,
    0.009667857550084591,
    -0.027504123747348785,
    0.04060668498277664,
    0.050082553178071976,
    0.014867178164422512,
    -0.012164735235273838,
    0.02739432081580162,
    -0.011048885062336922,
    0.05502982810139656,
    -0.02249545231461525,
    -0.02801520563662052,
    -0.000016386735296691768,
    -0.008208177983760834,
    -0.046310000121593475,
    0.10025914013385773,
    0.034476447850465775,
    -0.07431516796350479,
    -0.029488109052181244,
    0.02839023247361183,
    0.06196190044283867,
    -0.10616687685251236,
    -0.029500413686037064,
    -0.00641789473593235,
    -0.04587278887629509,
    -0.06931817531585693,
    0.0046709333546459675,
    -0.0006520336028188467,
    0.133549764752388,
    0.029736192896962166,
    -0.0074548423290252686,
    0.025987936183810234,
    -0.016903987154364586,
    -0.03504319489002228,
    -0.003909179475158453,
    0.02756825089454651,
    -6.222485637863429e-8,
    0.02496081031858921,
    -0.057850513607263565,
    -0.033813368529081345,
    0.09007003903388977,
    -0.023012222722172737,
    -0.04679597541689873,
    -0.05469536408782005,
    -0.08552388846874237,
    0.015532338060438633,
    -0.0777929276227951,
    -0.02148163877427578,
    0.013466361910104752,
    0.03650267422199249,
    -0.011752838268876076,
    0.05838129296898842,
    -0.06808419525623322,
    -0.026750385761260986,
    -0.011765297502279282,
    -0.0886935293674469,
    -0.025350436568260193,
    -0.07570923119783401,
    0.0490424707531929,
    0.012160930782556534,
    -0.02447585202753544,
    -0.008664839901030064,
    0.08703472465276718,
    0.09598670154809952,
    0.022757209837436676,
    0.01958998292684555,
    -0.022590626031160355,
    -0.0071970927529037,
    -0.041306234896183014,
    0.01830069161951542,
    -0.10230352729558945,
    -0.03377719223499298,
    -0.00836394913494587,
    0.12773239612579346,
    0.029817696660757065,
    0.09510818868875504,
    0.08596500009298325,
    0.03641751781105995,
    -0.01658354513347149,
    0.03888195753097534,
    0.025700701400637627,
    -0.03157523274421692,
    -0.08461902290582657,
    -0.04254269227385521,
    -0.0014074931386858225,
    0.05260757356882095,
    -0.07163257151842117,
    -0.10136586427688599,
    -0.03440408781170845,
    -0.005349121056497097,
    -0.07919197529554367,
    -0.05314761772751808,
    0.020765643566846848,
    0.011489881202578545,
    -0.024517718702554703,
    0.00433319341391325,
    -0.0015664773527532816,
    0.09053494781255722,
    -0.017680350691080093,
    -0.038221459835767746,
    -0.009534654207527637
  ],
  "text": "**Test Fix Status: user_profile_provider_test.dart**\n\nFixed compilation error on line 58 - changed `cancelSubscription` mock from returning `null` to returning `Future<void>` via `.thenAnswer((_) async {})`.\n\n**Current Test Results**: 6 passing, 3 failing\n- ✅ Passing: Tests that use the async provider pattern with proper createSubscription mocking (line 96-160)\n- ❌ Failing: Tests that use the old subscribeToEvents pattern or don't properly mock createSubscription callbacks\n\n**Root Cause of Failures**:\nThe setUp() block (lines 39-54) provides a generic createSubscription mock that only calls `onComplete` but never `onEvent`. This means:\n1. fetchProfile() gets called\n2. Batch fetch executes\n3. No profile events arrive (onEvent never called)\n4. onComplete triggers, marking profile as \"not found\"\n5. Test expects profile but gets null\n\n**Solution Pattern (from working test on line 96-160)**:\nEach test needs to override the generic mock with test-specific setup that:\n1. Creates a MockEvent with proper profile data\n2. Mocks createSubscription to call `onEvent(mockEvent)` via `Future.microtask()`\n3. Calls `onComplete` via `Future.delayed()` after event\n4. Returns subscription ID\n\n**Failing Tests Needing Updates**:\n1. \"should use notifier for basic profile management\" (line 162-198)\n2. \"should handle multiple individual profile fetches\" (line 231-273)\n3. \"should force refresh cached profile\" (line 306-352)\n\n**Mechanical Pattern to Apply**:\nFor each failing test, add before the test logic:\n```dart\n// Setup mock event\nfinal mockEvent = MockEvent();\nwhen(() => mockEvent.kind).thenReturn(0);\nwhen(() => mockEvent.pubkey).thenReturn(pubkey);\nwhen(() => mockEvent.id).thenReturn('event-id');\nwhen(() => mockEvent.createdAt).thenReturn(1234567890);\nwhen(() => mockEvent.content).thenReturn('{\"name\":\"Test Name\"}');\nwhen(() => mockEvent.tags).thenReturn([]);\n\n// Override createSubscription mock for this test\nwhen(() => mockSubscriptionManager.createSubscription(\n      name: any(named: 'name'),\n      filters: any(named: 'filters'),\n      onEvent: any(named: 'onEvent'),\n      onError: any(named: 'onError'),\n      onComplete: any(named: 'onComplete'),\n      priority: any(named: 'priority'),\n    )).thenAnswer((invocation) async {\n  final onEvent = invocation.namedArguments[const Symbol('onEvent')] as void Function(Event);\n  final onComplete = invocation.namedArguments[const Symbol('onComplete')] as void Function()?;\n  Future.microtask(() => onEvent(mockEvent));\n  Future.delayed(const Duration(milliseconds: 50), onComplete);\n  return 'test-subscription-id';\n});\n```\n\nThis is a mechanical update pattern that needs to be applied to ~3 tests in this file. The pattern is well-established by the working test.",
  "sections": [
    "Project Notes"
  ],
  "timestamp": 1762118556238,
  "path": "/Users/rabble/code/andotherstuff/openvine/mobile/.private-journal/2025-11-03/10-22-36-238415.md"
}